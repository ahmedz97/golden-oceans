<section class="pageBanner mb-5">
  <div
    class="text-capitalize text-white fw-bold h-100 flexCenter justify-content-end pb-5 mb-5 flex-column"
  >
    <h2 class="fw-bold">{{ "makeTrip.makeYourTrip" | translate }}</h2>
    <nav style="--bs-breadcrumb-divider: '✈️'" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a [routerLink]="['/']" class="text-decoration-none text-white"
            >{{ "nav.home" | translate }}</a
          >
        </li>
        <li class="breadcrumb-item active text-white" aria-current="page">
          {{ "makeTrip.makeYourTrip" | translate }}
        </li>
      </ol>
    </nav>
  </div>
</section>

<section class="" id="makeTrip">
  <div class="container">
    <mat-stepper class="text-capitalize" #stepper>
      <!-- Step 1: Choose Destinations -->
      <mat-step class="flyBtnsBox" [stepControl]="firstFormGroup">
        <form [formGroup]="firstFormGroup">
          <ng-template matStepLabel>{{
            "makeTrip.chooseDestinations" | translate
          }}</ng-template>
          <div class="row gy-3 gx-4 my-4 chooseDestination">
            <div
              class="js-check col-lg-4 col-md-6"
              *ngFor="let destination of destinationList"
            >
              <input
                type="radio"
                hidden
                [id]="destination.id"
                [value]="destination.title"
                formControlName="destination"
                (check)="onToursChange($event)"
                required
              />
              <label [for]="destination.id" class="w-100">
                <div class="tourDestinationCard w-100">
                  <figure
                    class="position-relative overflow-hidden rounded-3 rounded-bottom-0 mb-0 w-100"
                  >
                    <img
                      [src]="destination.featured_image"
                      class="w-100"
                      height="220"
                      [alt]="destination.title"
                      [title]="destination.title"
                    />
                    <i
                      class="fa fa-check fs-1 textMainColor position-absolute top-0 end-0 m-3"
                    ></i>
                  </figure>
                  <figcaption
                    class="card_data shadow rounded-bottom-3 text-center"
                  >
                    <h2 class="h4 p-2 fw-bold">{{ destination.title }}</h2>
                  </figcaption>
                </div>
              </label>
            </div>
          </div>
          <div class="text-center my-4 flyBtns">
            <button class="mainBtn Btn px-4" matStepperNext>
              {{ "makeTrip.next" | translate }}
            </button>
          </div>
        </form>
      </mat-step>

      <!-- Step 2: Pickup Travel Dates -->
      <mat-step [stepControl]="secondFormGroup">
        <form [formGroup]="secondFormGroup">
          <ng-template matStepLabel>{{
            "makeTrip.pickupTravelDates" | translate
          }}</ng-template>
          <div class="row g-3 my-4">
            <div class="col-lg-5">
              <mat-radio-group
                class="d-flex flex-column"
                aria-label="Pickup Travel Dates"
                formControlName="type"
              >
                <mat-radio-button checked value="exact_time">{{
                  "makeTrip.knowExactDates" | translate
                }}</mat-radio-button>
                <mat-radio-button value="approx_time">{{
                  "makeTrip.approximateDates" | translate
                }}</mat-radio-button>
              </mat-radio-group>
            </div>
            <div
              class="col-lg-6 flex-grow-1"
              *ngIf="isDateTypeSelected('exact_time')"
            >
              <mat-form-field
                appearance="outline"
                class="w-100 date-range-field"
              >
                <mat-label>{{ "makeTrip.selectDateRange" | translate }}</mat-label>
                <mat-date-range-input
                  [formGroup]="secondFormGroup"
                  [rangePicker]="picker"
                >
                  <input
                    matStartDate
                    matInput
                    formControlName="start_date"
                    placeholder="{{ 'makeTrip.startDate' | translate }}"
                    class="date-input"
                  />
                  <input
                    matEndDate
                    matInput
                    formControlName="end_date"
                    placeholder="{{ 'makeTrip.endDate' | translate }}"
                    class="date-input"
                  />
                </mat-date-range-input>
                <mat-datepicker-toggle
                  matIconSuffix
                  matInput
                  [for]="picker"
                ></mat-datepicker-toggle>
                <mat-date-range-picker #picker></mat-date-range-picker>
              </mat-form-field>
            </div>
            <div
              class="col-lg-6 flex-grow-1"
              *ngIf="isDateTypeSelected('approx_time')"
            >
              <div class="d-flex justify-content-between">
                <mat-form-field>
                  <mat-label>{{ "makeTrip.selectMonth" | translate }}</mat-label>
                  <mat-select formControlName="month">
                    <mat-option
                      *ngFor="let month of monthList; let i = index"
                      [value]="i + 1"
                      >{{ month }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-between">
            <button class="mainBtn Btn px-4" matStepperPrevious>
              {{ "makeTrip.back" | translate }}
            </button>
            <button class="mainBtn Btn px-4" matStepperNext>
              {{ "makeTrip.next" | translate }}
            </button>
          </div>
        </form>
      </mat-step>

      <!-- Step 3: Submit -->
      <mat-step class="flyBtnsBox" [stepControl]="submitFormGroup">
        <form [formGroup]="submitFormGroup">
          <ng-template matStepLabel>{{
            "makeTrip.completeData" | translate
          }}</ng-template>
          <div class="row g-3 my-4">
            <div class="col-md-3">
              <mat-form-field class="w-100">
                <mat-label>{{ "makeTrip.firstName" | translate }}</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="first_name"
                  placeholder="ahmed"
                  class="border-0"
                />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field class="w-100">
                <mat-label>{{ "makeTrip.lastName" | translate }}</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="last_name"
                  placeholder="zenger"
                  class="border-0"
                />
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-form-field class="w-100">
                <mat-label>{{ "makeTrip.email" | translate }}</mat-label>
                <input
                  type="email"
                  matInput
                  formControlName="email"
                  placeholder="ahmed@gmail.com"
                  class="border-0"
                />
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-form-field class="w-100">
                <mat-label>{{ "auth.nationality" | translate }}</mat-label>
                <mat-select formControlName="nationality">
                  <mat-option
                    *ngFor="let item of countriesList"
                    [value]="item.name"
                    >{{ item.name }}</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-form-field class="w-100">
                <mat-label>{{ "auth.phoneNumber" | translate }}</mat-label>
                <input
                  type="tel"
                  matInput
                  formControlName="phone_number"
                  placeholder="01069769249"
                  class="border-0"
                />
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>{{ "makeTrip.minBudget" | translate }}</mat-label>
                <input
                  matInput
                  type="number"
                  formControlName="min_person_budget"
                  (input)="onBudgetChange()"
                />
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>{{ "makeTrip.maxBudget" | translate }}</mat-label>
                <input
                  matInput
                  type="number"
                  formControlName="max_person_budget"
                  (input)="onBudgetChange()"
                />
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center">
                <input
                  type="checkbox"
                  id="flight_offer"
                  formControlName="flight_offer"
                  class="me-3"
                />
                <label for="flight_offer">{{
                  "makeTrip.addFlightOffer" | translate
                }}</label>
              </div>
            </div>
          </div>
          <div class="row g-3 my-3">
            <div class="col-md-4">
              <label>{{ "makeTrip.adults" | translate }}</label>
              <div
                class="content border rounded-3 d-flex justify-content-around align-items-center p-2"
              >
                <button (click)="decrement('adults')" class="mainBtn Btn fs-5">
                  -
                </button>
                <span>{{ submitFormGroup.get("adults")?.value }}</span>
                <input type="hidden" value="0" formControlName="adults" />
                <button (click)="increment('adults')" class="mainBtn Btn fs-5">
                  +
                </button>
              </div>
            </div>
            <div class="col-md-4">
              <label>{{ "makeTrip.children" | translate }}</label>
              <div
                class="content border rounded-3 d-flex justify-content-around align-items-center p-2"
              >
                <button
                  (click)="decrement('children')"
                  class="mainBtn Btn fs-5"
                >
                  -
                </button>
                <span>{{ submitFormGroup.get("children")?.value }}</span>
                <input type="hidden" value="0" formControlName="children" />
                <button
                  (click)="increment('children')"
                  class="mainBtn Btn fs-5"
                >
                  +
                </button>
              </div>
            </div>
            <div class="col-md-4">
              <label>{{ "makeTrip.infants" | translate }}</label>
              <div
                class="content border rounded-3 d-flex justify-content-around align-items-center p-2"
              >
                <button (click)="decrement('infants')" class="mainBtn Btn fs-5">
                  -
                </button>
                <span>{{ submitFormGroup.get("infants")?.value }}</span>
                <input type="hidden" value="0" formControlName="infants" />
                <button (click)="increment('infants')" class="mainBtn Btn fs-5">
                  +
                </button>
              </div>
            </div>
          </div>
          <mat-form-field appearance="fill" class="w-100 mt-3">
            <mat-label>{{ "makeTrip.notes" | translate }}</mat-label>
            <textarea
              matInput
              formControlName="additional_notes"
              rows="3"
              placeholder="{{ 'makeTrip.addNotesHere' | translate }}"
            ></textarea>
          </mat-form-field>
          <div class="d-flex justify-content-between mt-4 flyBtns">
            <button class="mainBtn Btn px-4" matStepperPrevious>
              {{ "makeTrip.back" | translate }}
            </button>
            <button (click)="submitForm()" class="mainBtn Btn">
              {{ "makeTrip.inquire" | translate }}
            </button>
            <button class="mainBtn Btn px-4" (click)="stepper.reset()">
              {{ "makeTrip.reset" | translate }}
            </button>
          </div>
        </form>
      </mat-step>
    </mat-stepper>
  </div>
</section>
