<section class="pageBanner mb-5">
  <div
    class="text-capitalize text-white fw-bold h-100 flexCenter justify-content-end pb-5 mb-5 flex-column"
  >
    <h2 class="fw-bold">my Profile</h2>
    <nav style="--bs-breadcrumb-divider: '✈️'" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a [routerLink]="['/']" class="text-decoration-none text-white"
            >Home</a
          >
        </li>
        <li class="breadcrumb-item active text-white" aria-current="page">
          my Profile
        </li>
      </ol>
    </nav>
  </div>
</section>

<section class="my-5">
  <div class="container">
    <div class="row g-3">
      <div class="col-lg-4">
        <div class="border specialBorder bg-white p-3">
          <div class="imgBox mx-auto">
            <ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
              <ngx-dropzone-label>Upload Your Image</ngx-dropzone-label>

              @for (file of files(); track file) {
              <ngx-dropzone-image-preview
                [file]="file"
                [removable]="true"
                (removed)="onRemove(file)"
                class="dz-thumb"
              >
              </ngx-dropzone-image-preview>
              }
            </ngx-dropzone>

            <!-- image name  -->
            <!-- <div class="my-2 textSecondColor" *ngIf="files().length">
              @for (file of files(); track $index) {<strong>{{
                file.name
              }}</strong
              >}
            </div> -->
          </div>
          <!-- user name and email -->
          <div class="textSecondColor text-center mt-2 pb-3 bs-popover-bottom">
            <h5 class="text-capitalize mb-0 fw-bold">
              {{ profilemeData.name }}
            </h5>
            <p class="">{{ profilemeData.email }}</p>
            <p class="text-success">{{ uploadedImageMassage }}</p>
          </div>

          <ul class="list-unstyled text-capitalize">
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'dashboard'"
              [class.bgMainColor]="selectedTab === 'dashboard'"
              (click)="selectedTab = 'dashboard'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'dashboard'"
                [class.text-white]="selectedTab === 'dashboard'"
                class="fa fa-gauge me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'dashboard'"
                [class.text-white]="selectedTab === 'dashboard'"
                >dashboard</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'myProfile'"
              [class.bgMainColor]="selectedTab === 'myProfile'"
              (click)="selectedTab = 'myProfile'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'myProfile'"
                [class.text-white]="selectedTab === 'myProfile'"
                class="fa fa-id-card me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'myProfile'"
                [class.text-white]="selectedTab === 'myProfile'"
                >my profile</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'myBooking'"
              [class.bgMainColor]="selectedTab === 'myBooking'"
              (click)="selectedTab = 'myBooking'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'myBooking'"
                [class.text-white]="selectedTab === 'myBooking'"
                class="fa fa-clipboard-list me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'myBooking'"
                [class.text-white]="selectedTab === 'myBooking'"
                >my booking</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'myCredit'"
              [class.bgMainColor]="selectedTab === 'myCredit'"
              (click)="selectedTab = 'myCredit'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'myCredit'"
                [class.text-white]="selectedTab === 'myCredit'"
                class="fa fa-clipboard-list me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'myCredit'"
                [class.text-white]="selectedTab === 'myCredit'"
                >my credit</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'myWishlist'"
              [class.bgMainColor]="selectedTab === 'myWishlist'"
              (click)="selectedTab = 'myWishlist'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'myWishlist'"
                [class.text-white]="selectedTab === 'myWishlist'"
                class="fa fa-heart-circle-plus me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'myWishlist'"
                [class.text-white]="selectedTab === 'myWishlist'"
                >my wishlist</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'setting'"
              [class.bgMainColor]="selectedTab === 'setting'"
              (click)="selectedTab = 'setting'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'setting'"
                [class.text-white]="selectedTab === 'setting'"
                class="fa fa-gear me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'setting'"
                [class.text-white]="selectedTab === 'setting'"
                >settings</span
              >
            </li>
            <li
              role="button"
              [class.bg-transparent]="selectedTab !== 'logout'"
              [class.bgMainColor]="selectedTab === 'logout'"
              (click)="logout()"
              (click)="selectedTab = 'logout'"
              class="mb-2 p-2 specialBorder"
            >
              <i
                [class.textMainColor]="selectedTab !== 'logout'"
                [class.text-white]="selectedTab === 'logout'"
                class="fa fa-arrow-right-from-bracket me-2"
              ></i>
              <span
                [class.textSecondColor]="selectedTab !== 'logout'"
                [class.text-white]="selectedTab === 'logout'"
                >logout</span
              >
            </li>
          </ul>
        </div>
      </div>
      <div class="col-lg-8">
        <div>
          @if (selectedTab==='dashboard') {
          <div class="row g-3">
            <div class="col-md-6">
              <div class="p-3 specialBorder border flexBetween">
                <div class="textSecondColor">
                  <b class="fs-3">{{ tourCart.length }}</b>
                  <p class="mb-1 text-capitalize">total booking</p>
                </div>
                <div class="iconBox m-0 bg-transparent text-danger">
                  <i class="fa fa-shopping-cart"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="p-3 specialBorder border flexBetween">
                <div class="textSecondColor">
                  <b class="fs-3">{{ favList.length }}</b>
                  <p class="mb-1 text-capitalize">favorite tour</p>
                </div>
                <div class="iconBox m-0 bg-white text-danger">
                  <i class="fa fa-heart-circle-plus"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="p-3 specialBorder border flexBetween">
                <div class="textSecondColor">
                  <b class="fs-3">{{ loyaltyCredit?.points || 0 }}</b>
                  <p class="mb-1 text-capitalize">total points</p>
                </div>
                <div class="iconBox m-0 bg-white text-danger">
                  <i class="fa fa-coins"></i>
                </div>
              </div>
            </div>
          </div>

          } @if (selectedTab==='myProfile') {
          <div
            class="p-4 border sideBar rounded-3 textSecondColor text-capitalize"
          >
            <h5 class="fw-bold mb-3 pb-3 border-bottom">profile info</h5>

            <p><b class="me-5">Full Name:</b> {{ profilemeData.name }}</p>
            <p><b class="me-5">Email:</b> {{ profilemeData.email }}</p>
            <p><b class="me-5">Phone:</b>{{ profilemeData.phone }}</p>
            <!-- <p><b class="me-5">Address:</b>New York, USA</p> -->
            <p>
              <b class="me-5">Nationality:</b>{{ profilemeData.nationality }}
            </p>
            <p>
              <b class="me-5">Birth Date:</b
              >{{ profilemeData.birthdate | date }}
            </p>
            <p>
              <b class="me-5">Join Date:</b
              >{{ profilemeData.created_at | date }}
            </p>
          </div>
          } @if (selectedTab==='myCredit') {
          <div
            class="p-4 border sideBar rounded-3 textSecondColor text-capitalize"
          >
            <h5 class="fw-bold mb-3 pb-3 border-bottom">credit info</h5>

            <form
              [formGroup]="transferLoyaltyCreditForm"
              (ngSubmit)="transferLoyaltyCredit()"
            >
              <div class="mb-3">
                <label
                  for="recipient_email"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >recipient email</label
                >
                <div class="item position-relative">
                  <input
                    type="email"
                    id="recipient_email"
                    formControlName="recipient_email"
                    placeholder="Your Email "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-file-signature textMainColor"></i>
                </div>
              </div>
              <div class="mb-3">
                <label
                  for="points"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >points</label
                >
                <div class="item position-relative">
                  <input
                    type="number"
                    id="points"
                    formControlName="points"
                    placeholder="Enter Your points "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-file-signature textMainColor"></i>
                </div>
              </div>
              <div class="mb-3">
                <label
                  for="notes"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >notes</label
                >
                <div class="item position-relative">
                  <textarea
                    id="notes"
                    formControlName="notes"
                    placeholder="add notes ... "
                    class="form-control p-2 ps-5 rounded-3"
                  ></textarea>
                  <i class="fa fa-file-signature textMainColor"></i>
                </div>
              </div>

              <button type="submit" class="mainBtn Btn">
                transfer loyalty points
              </button>
            </form>
          </div>
          } @if (selectedTab==='myBooking') { @if (haveData) {
          <owl-carousel-o [options]="bookingOptions">
            @for (cart of tourCart; track $index) {
            <ng-template carouselSlide>
              <app-tour-cart [tour]="cart.tour"></app-tour-cart>
              <div class="text-capitalize textSecondColor mt-4">
                <h6>
                  guest:
                  <b *ngIf="cart.adults" class="textMainColor"
                    >{{ cart.adults }} adults</b
                  >
                  ,<b *ngIf="cart.children" class="textMainColor"
                    >{{ cart.children }} children</b
                  >
                  ,<b *ngIf="cart.infants" class="textMainColor"
                    >{{ cart.infants }} infants</b
                  >
                </h6>
                <h6>
                  total price :
                  <b class="textMainColor">{{ cart.totalPrice | currency }}</b>
                </h6>
                <h6>
                  booking date :<b class="textMainColor">{{
                    cart.start_date | date
                  }}</b>
                </h6>
              </div>
            </ng-template>
            }
          </owl-carousel-o>
          }@else {
          <h2 class="text-danger text-capitalize">no tour in booking cart</h2>
          } } @if (selectedTab==='myWishlist') { @if (haveData) {
          <owl-carousel-o [options]="bookingOptions">
            @for (cart of favList; track $index) {
            <ng-template carouselSlide>
              <app-tour-cart [tour]="cart.tour"></app-tour-cart>
            </ng-template>
            }
          </owl-carousel-o>
          }@else {
          <h2 class="text-danger text-capitalize">no tour in wishlist</h2>
          } } @if (selectedTab==='setting') {
          <form
            [formGroup]="updateProfile"
            (ngSubmit)="submitProfileData()"
            class="row g-3"
          >
            <div class="col-md-6">
              <div class="mb-2">
                <label
                  for="name"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >full name</label
                >
                <div class="item position-relative">
                  <input
                    type="text"
                    id="name"
                    formControlName="name"
                    placeholder="Your Full Name "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-file-signature textMainColor"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-2">
                <label
                  for="phone"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                >
                  phone</label
                >
                <div class="item position-relative">
                  <input
                    type="tel"
                    id="phone"
                    formControlName="phone"
                    placeholder="Your phone "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-phone-volume textMainColor"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-2">
                <label
                  for="password"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >password</label
                >
                <div class="item position-relative">
                  <input
                    type="password"
                    id="password"
                    formControlName="password"
                    placeholder="Your Password "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-lock textMainColor"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-2">
                <label
                  for="password_confirmation"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >password_confirmation</label
                >
                <div class="item position-relative">
                  <input
                    type="password"
                    id="password_confirmation"
                    formControlName="password_confirmation"
                    placeholder="Your Password Confirmation "
                    class="form-control p-2 ps-5 rounded-3"
                  />
                  <i class="fa fa-lock textMainColor"></i>
                </div>
              </div>
            </div>
            <div class="col-12">
              <div class="mb-2">
                <label
                  for="nationality"
                  class="textSecondColor text-capitalize fw-bold mb-2"
                  >nationality</label
                >
                <div class="item position-relative">
                  <select
                    id="nationality"
                    formControlName="nationality"
                    class="form-control p-2 ps-5 rounded-3"
                  >
                    <option value="" hidden disabled selected>
                      select your nationality
                    </option>
                    @for (item of countriesList; track $index) {

                    <option [value]="item.name">{{ item.name }}</option>
                    }
                  </select>
                  <i class="fa fa-globe textMainColor"></i>
                </div>
              </div>
            </div>

            <div>
              <button type="submit" class="Btn mainBtn">
                update profile info
              </button>
            </div>
          </form>
          }
        </div>
      </div>
    </div>
  </div>
</section>
